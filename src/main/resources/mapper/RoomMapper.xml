<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.stampsysback.mapper.RoomMapper">

    <!-- ★ ここを追加: RoomResult の定義 -->
    <resultMap id="RoomResult" type="com.example.stampsysback.entity.RoomEntity">
        <id     column="room_id"   property="roomId"/>
        <result column="room_name" property="roomName"/>
        <result column="class_id"  property="classId"/>
        <result column="active"    property="active"/>
        <result column="created_at" property="createdAt"/>
    </resultMap>

    <select id="selectByClassId"
            parameterType="int"
            resultMap="RoomResult">
        SELECT room_id, room_name, class_id, active, created_at
        FROM rooms
        WHERE class_id = #{classId}
        ORDER BY room_id;
    </select>

    <insert id="insert" parameterType="com.example.stampsysback.entity.RoomEntity">
        INSERT INTO rooms (room_id, room_name, class_id, active, created_at)
        VALUES (#{roomId}, #{roomName}, #{classId}, #{active}, #{createdAt})
    </insert>

    <select id="selectById" parameterType="int" resultMap="RoomResult">
        SELECT room_id, room_name, class_id, active, created_at
        FROM rooms
        WHERE room_id = #{roomId}
    </select>

    <select id="selectByNameAndClass" resultMap="RoomResult" parameterType="map">
        SELECT room_id, room_name, class_id, active, created_at
        FROM rooms
        WHERE room_name = #{roomName} AND class_id = #{classId}
            LIMIT 1
    </select>

    <select id="selectMaxRoomId" resultType="int">
        SELECT COALESCE(MAX(room_id), 0) FROM rooms
    </select>

</mapper>