<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>アプリケーション</title>
</head>
<body>
<h1>ダッシュボード</h1>

<!-- 現在のログインユーザー情報（DB の User エンティティ） -->
<div th:if="${user != null}">
    <p>ログイン:
        <span th:text="${user.userName}">User Name</span>
        （権限:
        <span th:switch="${user.role}">
            <span th:case="'ADMIN'">管理者</span>
            <span th:case="'STUDENT'">学生</span>
            <span th:case="'TEACHER'">教員</span>
            <span th:case="*"><span th:text="${user.role}">ROLE</span></span>
        </span>
        ）
    </p>
</div>

<h2>ユーザー一覧</h2>
<table border="1">
    <thead>
    <tr>
        <th>user_id</th>
        <th>名前 / メール</th>
        <th>権限</th>
        <th th:if="${user != null and user.role == 'ADMIN'}">編集</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="u : ${users}">
        <td th:text="${u.userId}">1</td>
        <td>
            <div th:text="${u.userName}">名前</div>
            <div th:text="${u.email}">email@example.com</div>
        </td>
        <td>
            <span th:switch="${u.role}">
                <span th:case="'ADMIN'">管理者</span>
                <span th:case="'STUDENT'">学生</span>
                <span th:case="'TEACHER'">教員</span>
                <span th:case="*"><span th:text="${u.role}">ROLE</span></span>
            </span>
        </td>
        <td th:if="${user != null and user.role == 'ADMIN'}">
            <!-- 管理者のみ見えるロール変更フォーム -->
            <form th:action="@{'/users/' + ${u.userId} + '/role'}" method="post">
                <select name="role">
                    <option th:selected="${u.role == 'STUDENT'}" value="STUDENT">学生</option>
                    <option th:selected="${u.role == 'TEACHER'}" value="TEACHER">教員</option>
                    <option th:selected="${u.role == 'ADMIN'}" value="ADMIN">管理者</option>
                    <!-- 必要に応じて他のロールを追加 -->
                </select>
                <button type="submit">更新</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>

</body>
</html>