<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <title>Users - stampsys</title>-->
<!--    <style>-->
<!--        body { font-family: Arial, Helvetica, sans-serif; margin: 20px; }-->
<!--        table { border-collapse: collapse; width: 100%; }-->
<!--        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }-->
<!--        th { background: #f7f7f7; }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<h1>Users (users テーブルの中身)</h1>-->
<!--<p>合計: <span th:text="${users.size()}">0</span></p>-->
<!--<table>-->
<!--    <thead>-->
<!--    <tr>-->
<!--        <th>user_id</th>-->
<!--        <th>user_name</th>-->
<!--        <th>provider_user_id</th>-->
<!--        <th>email</th>-->
<!--        <th>role</th>-->
<!--        <th>created_at</th>-->
<!--    </tr>-->
<!--    </thead>-->
<!--    <tbody>-->
<!--    <tr th:each="u : ${users}">-->
<!--        <td th:text="${u.userId}">-</td>-->
<!--        <td th:text="${u.userName}">-</td>-->
<!--        <td th:text="${u.providerUserId}">-</td>-->
<!--        <td th:text="${u.email}">-</td>-->
<!--        <td th:text="${u.role}">-</td>-->
<!--        <td th:text="${u.createdAt}">-</td>-->
<!--    </tr>-->
<!--    <tr th:if="${users.size()} == 0">-->
<!--        <td colspan="6">データがありません</td>-->
<!--    </tr>-->
<!--    </tbody>-->
<!--</table>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>ユーザー一覧</title>
    <style>
        /* 最低限の見た目 */
        .avatar {
            width: 36px; height:36px; border-radius:50%;
            display:inline-flex; align-items:center; justify-content:center;
            color:white; font-weight:600;
        }
        .row { display:flex; align-items:center; padding:8px 0; border-bottom:1px solid #eee; }
        .col { padding: 0 12px; }
        .name { flex: 1; }
        .email { flex: 1.5; color:#666; }
        .role { width:200px; }
    </style>
</head>
<body>
<h1>ユーザー一覧</h1>

<div th:if="${users == null}">
    <p>ユーザーが取得できませんでした。</p>
</div>

<div th:if="${users != null}">
    <div th:each="user : ${users}">
        <div class="row">
            <div class="col">
                <span class="avatar" th:style="'background:' + ${#strings.substring(user.userName,0,1).hashCode() % 360}">
                    <span th:text="${#strings.substring(user.userName,0,1)}"></span>
                </span>
            </div>
            <div class="col name" th:text="${user.userName}">氏名</div>
            <div class="col email" th:text="${user.email}">email@example.com</div>
            <div class="col role">
                <form th:action="@{/users/{id}/role(id=${user.userId})}" method="post">
                    <!-- CSRF トークンが存在する場合のみ hidden input を出す -->
                    <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <select name="role">
                        <option th:value="ADMIN" th:selected="${user.role == 'ADMIN'}">管理者</option>
                        <option th:value="TEACHER" th:selected="${user.role == 'TEACHER'}">教員</option>
                        <option th:value="STUDENT" th:selected="${user.role == 'STUDENT'}">学生</option>
                    </select>
                    <button type="submit">変更</button>
                </form>
            </div>
        </div>
    </div>
</div>

</body>
</html>